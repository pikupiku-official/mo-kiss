# システム設計（To‑Be）

各モジュールの役割・入口・出口・状態更新を整理する。  

---

## TITLE
### 役割
- 起動画面
- 初期化の入口

### 想定機能
- 起動時にデモ動画を流す（特定キーでスキップ可能）
- スキップできる特定キーを右下にオーバーレイで表示
- タイトル画面に推移「PRESS ANY KEY」でMAIN_MANUへ遷移

### 入口
- main.py起動 → TITLE（固定）

### 出口
- TITLE → MAIN_MENU（固定）

### セーブ/OPTION
- セーブなし
- OPTIONなし

---

## MAIN_MENU
### 役割
- 新規/続きの入口

### 想定機能
- はじめから（プレイヤー名入力後、はじめのイベントを飛ばすかどうかを聞いてから、DIALOGUE(E001.ks)へ）
- つづきから（ロードして、保存時の状態へ推移）
- 設定
- ギャラリー（予定）

### 入口
- TITLE → MAIN_MANU（固定）
- 中断時の状態 → MAIN_MANU（メインメニューに戻る）

### 出口
- MAIN_MENU → DIALOGUE（新規開始でE001.ksをロード）
- MAIN_MENU → 保存時の状態（続きから）

### セーブ/OPTION
- セーブなし
- OPTIONなし（設定機能で設定は可能）

---

## HOME
### 役割
- 自宅シーン
- 日の切り替えや行動の起点

### 入口/出口
- 入り: MAIN_MENU / 帰宅
- 出: DIALOGUE（登校イベント） or MAP

### セーブ/OPTION
- セーブ可
- OPTION可

---

## DIALOGUE
### 役割
- 物語進行と分岐

### 入口
- MAPのイベント選択
- HOMEのイベント発火
- その他条件イベント

### 退出
- DIALOGUE → MAP（昼ループ）
- DIALOGUE → HOME（帰宅）

### 状態更新
- シナリオフラグは主にここで更新
- 時間はイベント終了で進む

### セーブ/OPTION
- セーブ不可
- OPTION可

---

## MAP
### 役割
- イベント選択と移動

### 遷移
- MAP → DIALOGUE（イベント開始）
- MAP → HOME（帰宅）

### 特記
- **時間スキップ用のUI/キー操作**を用意する

### セーブ/OPTION
- セーブ可
- OPTION可

---

## OPTION（Overlay）
### 役割
- ポーズ画面
- 設定/セーブ/ロード/メニュー戻り

### 振る舞い
- ポーズ
- BGM継続
- 即時反映

---

## バックエンド責務（案）
- セーブ: `save_manager.py`
- 時間: `time_manager.py`
- フラグ: スロット内の `story_flags.json`
- 名前: `data/current_state/player_name.json`
- 設定保存: `data/settings.json`

---

## 未決事項
- OPTIONの追加項目の精査
