# アーキテクチャ設計（To‑Be）

ゲームの実行モデルと遷移の考え方を定義する。  
設計の基準は「理想状態（To‑Be）の具体化」。

---

## 用語
- **Base State**  
  TITLE / MAIN_MENU / HOME / DIALOGUE / MAP の主画面
- **Overlay**  
  Base State の上に開く画面。ここでは OPTION
- **Event**  
  DIALOGUE を起動するストーリー単位（`events/E001.ks` など）

---

## 実行モデル（全体）
Entry: main.py
└─ Base State: TITLE / MAIN_MENU / HOME / DIALOGUE / MAP
└─ Overlay: OPTION

---

## 遷移の考え方
- **固定**: TITLE → MAIN_MENU
- それ以外は状況依存・イベント依存
- 遷移を一本道として扱わない

---

## 代表的な流れ（例）
- 起動: TITLE → MAIN_MENU
- 新規開始: MAIN_MENU → HOME
- 日中ループ: DIALOGUE ↔ MAP
- 帰宅: DIALOGUE → HOME
- 朝の出発: HOME → DIALOGUE（登校イベント） or HOME → MAP
- ロード: 保存時の状態へ復帰

※例であり固定ルートではない。

---

## OPTION（Overlay）
- **ポーズ扱い**
- **BGMは継続**
- **設定は即時反映**
- 開ける場所: HOME / DIALOGUE / MAP
- TITLE / MAIN_MENU では開けない

### 想定項目
- 音量
- キーコンフィグ
- 表示
- テキスト速度
- スキップ
- メインメニューに戻る
- セーブ / ロード
- 追加項目は `TBD`

---

## セーブ/ロード方針
- セーブ可能: HOME / MAP
- DIALOGUE中のセーブ: **不可**
- ロード: **保存時の状態へ復帰**
- オートセーブ: なし
- スロット: 別世界線として複数保持
- プレイヤー名: 「はじめから」で決定し、スロット内で固定

---

## MAPの時間スキップ
- 専用UIとキー操作で実行する

---

## バックエンド状態カテゴリ（参考）
- 設定
- シナリオフラグ
- 時間/日付
- セーブ状態
- プレイヤー名

---

## 未決事項
- OPTIONの追加項目の精査

